<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    <title>Магазин иллюстраций</title>
    <style>
      body {font-family: Montserrat;
        background: rgb(58, 46, 46);
        margin: 0;
        padding:32 px;
        color: rgb(255, 255, 255);
      }

      h1 {
        text-align: center;
        margin-bottom: 24px;
      }

      .panel {
        display:flex;
        justify-content: center;
        /* чтобы контент перемещался влево вправо */
        gap: 30px;
        /* отступ между элементами  */
        margin-bottom: 24px;
        /* отступ снизу  */
        flex-wrap: wrap; 
        /* с изменением страницы будет автоматом перемещаемым  */


     
      }
      .panel label {
        display:flex;
       align-items: center; 
       /* размещение прямо по центру */
        gap: 8px;
        font-size: 14px;
        background-color: rgb(70, 44, 44);
        border : 1px solid rgb(255, 255, 255);
        padding : 10px 14px;
        border-radius: 20px;
        /* скругление рамочек */

      }
      .panel input, .panel select {
      border : 4px solid rgb(255, 255, 255);
      border-radius: 10px;
      padding : 5px 15px;
      font-size: 14px;
      border : 1px solid rgb(255, 238, 238);

      }
      #products {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 2fr)); 
        /* 2 fr это для телефона если совсем маленький экран будут 2 показываться*/
        gap: 20px;
        margin : 0 auto; 
        /* отсупы по бокам автоматически */
        max-width: 1080px ; 
        /* максимальная ширина страницы */
      }

      .card {
        background: white;
        border : 1px solid rgb(255, 255, 255);
       border-radius: 10px;
        padding : 16px;
        box-shadow: 0 8px 20 px  ; 
        /* тени :  смещение радиус, размытия, тени цвет */
        color: brown;
        transition: trasform 0.15s ease, box-shadow 0.15s ease;
      }
/* анимация при наведении  */
      .card:hover { 
        transform: translateY(-4px);
        box-shadow: 0 16px 30px  rgb(181, 142, 142);        

      }

      .card img {
         width: 100%;
         height: 200px;
         object-fit: cover;

      }

      .badge {
        color: rgb(255, 255, 255);
        background: rgb(189, 101, 101);
        display:inline-flex;
        align-self: flex-start;
        font-size: 12px;
        margin-bottom: 8px;
        padding: 4px 8px;
        border-radius: 12px;      
      }
     

      

    </style>
  </head>
  <body>
    <h1>Популярные товары магазина</h1>
    <div class="panel">
      <label>
         Поиск :
         <input type="text" id="search" placeholder="например,игра на день рождения"> 
         <!-- плейсхолдер что показывается когда поле не заполнено -->
      </label>

       <label>
         Максимальная цена :
         <input type="number" id="price" placeholder="без ограничений"> 
         <!-- плейсхолдер что показывается когда поле не заполнено -->
      </label>

       <label>
         Категория :
         <select id="category"> 
        <option value="all"> Все </option>
        </select>
      </label>


    </div>

      <div id="products"></div>

    <script>

      const products = [
        {name: "Игра на корпоратив", price:20000, category: "Игры на мероприятия", badge: "К НГ", image: "corp.jpg"},
        {name: "Игра на день рождения", price:15000, category: "Игры на мероприятия", badge: "Хит продаж", image: "dr.jpg"},
        {name: "Тайна шести карманов: дело о художнике", price:2500, category: "Игры средней сложности", badge: "Самая популярная", image: "6k.jpg"},
        {name: "Последний куплет", price:3000, category: "Игры сложные", badge: "Самая непредсказумая", image: "kuplet.jpg"},
        {name: "Купидонские тайны", price:2500, category: "Игры простые", badge: "Любовных хаос", image: "kupid.jpg"}
      ]
      //массив данный где каждый продукт хранит в себе набор данных 

      //получение значений полей

      let productsBox = document.getElementById("products");
      let searchField = document.getElementById("search");
      let categorySelect = document.getElementById("category"); //  выпадающая менюшка категорий
      let priceField = document.getElementById("price");

      //функция по отрисовке продуктов 

      function drawProducts(list){
        productsBox.innerHTML ="";
      
        for (let i = 0; i <list.length; i++){
            let item = list[i];
            let card = document.createElement("div"); //создай элемент див контейнер куда помещаем карточку 
            card.className = "card";


            card.innerHTML = 
          `<span class="badge"> ${item.badge} </span>` +  
          `<img src="${item.image}" alt= "${item.name}"</img>`+
          `<p>Категория: ${item.category} </p>`+
          `<h2> ${item.name}</h2>` +
          `<p class="price"> ${item.price} </p>`;

        
          productsBox.appendChild(card);
          
        }
      }
     
      drawProducts(products);

      function updateList (){
        let text = searchField.value.toLowerCase();
        let category = categorySelect.value; //выбор категории
        let maxPrice = parseInt(priceField.value, 10) //получаем значения из прайсфилд и не больше 10 символов по цене

        let filtered = []; // данные по условиям от пользователя
        for (let i=0; i < products.length; i++) 
        {
          let product = products[i];
          matchesText = product.name.toLocaleLowerCase().indexOf(text) !==-1; //если в названии продукта встречается хоть буква есть 
          let matchesCategory = category === "all" || product.category === category // либо если выбрано знать все, иначе по выбранной категории
          let mathesPrice = isNaN(maxPrice) || product.price <=maxPrice; // пользователь сам указывает макс цену и тогда показывается все товары меньше чем его цена
          if (matchesText && matchesCategory && mathesPrice) //соотвествует ли продукт всем категориям 
          {
            filtered.push(product);
          }

        }
        drawProducts(filtered); // когда отфильтровали выводим на страницу 
      }

      //категории в список при поиске добавляем 

      function fillCategory() {
        let usingCategory = {};
        for (let i=0; i < products.length; i++){
          let category = products[i].category;
          if (!usingCategory[category])//добавляем категории  из того массива что у нас есть, если новый товар добавим, то категория автоматом подтянется
          {
            let option = document.createElement("option");
            option.value = category;
            option.textContent = category;
            categorySelect.appendChild(option);
            usingCategory[category]=true; //чтобы повторно не добавлялась
          }
        }


      }

      searchField.addEventListener("input", updateList);
      categorySelect.addEventListener("input", updateList);
     priceField.addEventListener ("input", updateList);

     fillCategory(); 



      drawProducts(products);

   

   </script>
  </body>
</html> 
